<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Solar System Explorer</title>
  <style>
    :root{
      --bg:#070a12;
      --panel: rgba(18, 24, 40, .75);
      --panel2: rgba(18, 24, 40, .55);
      --text:#e9eefc;
      --muted:#aab4d0;
      --line: rgba(255,255,255,.10);
      --accent:#7aa7ff;
      --accent2:#7cffd6;
      --danger:#ff6b8a;
      --shadow: 0 12px 40px rgba(0,0,0,.45);
    }
    *{ box-sizing:border-box; }
    html, body { height:100%; margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji"; background: radial-gradient(1200px 700px at 50% 40%, #121a36 0%, var(--bg) 55%, #02040b 100%); color: var(--text); overflow:hidden; }
    #app { height:100%; display:grid; grid-template-columns: 340px 1fr; }
    @media (max-width: 880px){
      #app { grid-template-columns: 1fr; grid-template-rows: auto 1fr; }
      #hud { position:relative; width:100%; }
    }

    /* Left panel */
    #hud{
      padding:16px;
      border-right:1px solid var(--line);
      background: linear-gradient(180deg, rgba(10,12,22,.9), rgba(10,12,22,.55));
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      z-index:5;
      display:flex;
      flex-direction:column;
      gap:12px;
      min-width: 280px;
    }
    .title{
      display:flex; align-items:center; gap:10px;
      padding:10px 12px;
      border:1px solid var(--line);
      border-radius:14px;
      background: var(--panel);
    }
    .logo{
      width:34px; height:34px; border-radius:12px;
      background: radial-gradient(circle at 30% 30%, #ffd36b 0%, #ff8d3a 28%, #9a3cff 60%, #1b2a72 100%);
      box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset, 0 10px 20px rgba(0,0,0,.35);
    }
    h1{ font-size:16px; margin:0; letter-spacing:.3px; }
    .subtitle{ margin:0; font-size:12px; color:var(--muted); }

    .section{
      border:1px solid var(--line);
      border-radius:14px;
      background: var(--panel2);
      padding:12px;
    }
    .section h2{
      margin:0 0 8px 0;
      font-size:12px;
      color: var(--muted);
      font-weight:650;
      text-transform: uppercase;
      letter-spacing: .12em;
    }

    .row{ display:flex; align-items:center; justify-content:space-between; gap:12px; margin:10px 0; }
    .row label{ font-size:13px; color: var(--text); opacity:.92; }
    .row small{ color: var(--muted); }
    input[type="range"]{ width: 180px; accent-color: var(--accent); }
    .pill{
      font-size:12px; color: var(--muted);
      border:1px solid var(--line);
      background: rgba(0,0,0,.25);
      padding:6px 10px;
      border-radius: 999px;
      white-space:nowrap;
    }
    .btnrow{ display:flex; gap:10px; flex-wrap:wrap; }
    button{
      cursor:pointer;
      border:1px solid var(--line);
      color: var(--text);
      background: rgba(0,0,0,.22);
      padding:10px 10px;
      border-radius:12px;
      font-weight:650;
      transition: transform .08s ease, background .12s ease, border-color .12s ease;
      user-select:none;
    }
    button:hover{ background: rgba(122,167,255,.10); border-color: rgba(122,167,255,.35); }
    button:active{ transform: translateY(1px); }
    button.primary{ background: rgba(122,167,255,.18); border-color: rgba(122,167,255,.45); }
    button.primary:hover{ background: rgba(122,167,255,.25); }
    button.danger:hover{ background: rgba(255,107,138,.14); border-color: rgba(255,107,138,.35); }

    .infoCard{
      border:1px solid var(--line);
      background: rgba(0,0,0,.18);
      border-radius: 14px;
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .planetHeader{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
    .planetName{ font-size:16px; font-weight:800; margin:0; }
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.22);
      color: var(--muted);
    }
    .dot{ width:10px; height:10px; border-radius: 99px; background: var(--accent2); box-shadow: 0 0 12px rgba(124,255,214,.35); }
    .kv{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
    .kv div{
      border:1px solid var(--line);
      background: rgba(0,0,0,.18);
      border-radius:12px;
      padding:10px;
    }
    .kv .k{ font-size:11px; color: var(--muted); letter-spacing:.08em; text-transform: uppercase; margin-bottom:4px; }
    .kv .v{ font-size:13px; font-weight:700; }
    .hint{ font-size:12px; color: var(--muted); line-height:1.4; }

    /* Canvas / scene */
    #stage{
      position:relative;
      height:100%;
      width:100%;
      overflow:hidden;
    }
    canvas{ width:100%; height:100%; display:block; }

    /* Overlay tooltip-ish */
    #overlayHint{
      position:absolute;
      left:12px; bottom:12px;
      padding:10px 12px;
      background: rgba(0,0,0,.30);
      border:1px solid var(--line);
      border-radius: 12px;
      backdrop-filter: blur(8px);
      color: var(--muted);
      font-size:12px;
      z-index:4;
      user-select:none;
      max-width: min(520px, calc(100% - 24px));
    }
    kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size: 11px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.35);
      padding:2px 6px;
      border-radius: 8px;
      color: var(--text);
    }
    a{ color: var(--accent); text-decoration:none; }
    a:hover{ text-decoration:underline; }
  </style>
</head>
<body>
  <div id="app">
    <aside id="hud">
      <div class="title">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Solar System Explorer</h1>
          <p class="subtitle">Click planets • Drag to rotate • Scroll to zoom</p>
        </div>
      </div>

      <div class="section">
        <h2>Controls</h2>

        <div class="row">
          <label for="speed">Orbit speed</label>
          <span class="pill"><span id="speedVal">1.00×</span></span>
        </div>
        <input id="speed" type="range" min="0" max="3" value="1" step="0.01" />

        <div class="row">
          <label for="tilt">Orbit tilt</label>
          <span class="pill"><span id="tiltVal">20°</span></span>
        </div>
        <input id="tilt" type="range" min="0" max="60" value="20" step="1" />

        <div class="row">
          <label for="labels">Labels</label>
          <span class="pill"><span id="labelsVal">On</span></span>
        </div>
        <input id="labels" type="range" min="0" max="1" value="1" step="1" />

        <div class="btnrow" style="margin-top:10px;">
          <button id="pauseBtn" class="primary">Pause</button>
          <button id="resetBtn">Reset view</button>
          <button id="randomBtn">Randomize orbits</button>
        </div>

        <p class="hint" style="margin:10px 0 0 0;">
          Tip: drag anywhere on the scene to rotate. Use mouse wheel / trackpad to zoom.
          Press <kbd>Space</kbd> to pause/resume, <kbd>R</kbd> to reset.
        </p>
      </div>

      <div class="section">
        <h2>Planet info</h2>
        <div class="infoCard" id="infoCard" aria-live="polite">
          <div class="planetHeader">
            <p class="planetName" id="planetName">Sun</p>
            <span class="badge"><span class="dot" id="planetDot"></span><span id="planetType">Star</span></span>
          </div>
          <div class="kv">
            <div><div class="k">Distance</div><div class="v" id="planetDist">—</div></div>
            <div><div class="k">Year length</div><div class="v" id="planetYear">—</div></div>
            <div><div class="k">Radius</div><div class="v" id="planetRadius">—</div></div>
            <div><div class="k">Fun fact</div><div class="v" id="planetFact">Click a planet</div></div>
          </div>
          <p class="hint" style="margin:8px 0 0 0;">
            Data is approximate (scaled for visualization).
          </p>
        </div>
      </div>

      <div class="section">
        <h2>Legend</h2>
        <p class="hint" style="margin:0;">
          The solar system is not to scale in size or distance. Orbits are drawn as ellipses with an adjustable tilt to give
          a 3D-ish look.
        </p>
      </div>
    </aside>

    <main id="stage">
      <canvas id="c" aria-label="Solar system visualization"></canvas>
      <div id="overlayHint">
        <strong style="color:var(--text);">Interact:</strong>
        Drag to rotate • Scroll to zoom • Click a planet for info • <kbd>Space</kbd> pause • <kbd>R</kbd> reset
      </div>
    </main>
  </div>

<script>
(() => {
  // ---------- Utilities ----------
  const clamp = (v, a, b) => Math.max(a, Math.min(b, v));
  const lerp = (a, b, t) => a + (b - a) * t;

  function fmtAU(au){ return `${au.toFixed(2)} AU`; }
  function fmtDays(d){
    if (d >= 365) return `${(d/365).toFixed(2)} yr`;
    return `${Math.round(d)} d`;
  }
  function fmtKm(km){
    if (km >= 100000) return `${(km/1000).toFixed(0)}k km`;
    return `${km.toFixed(0)} km`;
  }

  // ---------- Canvas setup ----------
  const canvas = document.getElementById('c');
  const ctx = canvas.getContext('2d', { alpha: true });

  function resize() {
    const dpr = Math.max(1, window.devicePixelRatio || 1);
    const rect = canvas.getBoundingClientRect();
    canvas.width = Math.floor(rect.width * dpr);
    canvas.height = Math.floor(rect.height * dpr);
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  }
  window.addEventListener('resize', resize, { passive: true });
  resize();

  // ---------- UI elements ----------
  const speedEl = document.getElementById('speed');
  const speedVal = document.getElementById('speedVal');
  const tiltEl = document.getElementById('tilt');
  const tiltVal = document.getElementById('tiltVal');
  const labelsEl = document.getElementById('labels');
  const labelsVal = document.getElementById('labelsVal');

  const pauseBtn = document.getElementById('pauseBtn');
  const resetBtn = document.getElementById('resetBtn');
  const randomBtn = document.getElementById('randomBtn');

  const info = {
    name: document.getElementById('planetName'),
    type: document.getElementById('planetType'),
    dot: document.getElementById('planetDot'),
    dist: document.getElementById('planetDist'),
    year: document.getElementById('planetYear'),
    radius: document.getElementById('planetRadius'),
    fact: document.getElementById('planetFact'),
  };

  // ---------- Scene / camera ----------
  const cam = {
    rot: 0,        // rotation around sun in view space (radians)
    zoom: 1.0,     // scalar
    targetRot: 0,
    targetZoom: 1.0,
    panX: 0,       // reserved if you want panning later
    panY: 0
  };

  function resetView(){
    cam.rot = cam.targetRot = 0;
    cam.zoom = cam.targetZoom = 1.0;
  }

  // ---------- Solar system data (approx.) ----------
  // distance: semi-major axis in AU (visual scaling)
  // period: orbital period in Earth days
  // radius: km (for info only; visual size is stylized)
  const planets = [
    { id:'mercury', name:'Mercury', type:'Terrestrial', color:'#b8b8b8', distanceAU:0.39, periodDays:88, radiusKm:2439.7, fact:'Smallest planet; huge temperature swings.' },
    { id:'venus',   name:'Venus',   type:'Terrestrial', color:'#d7b37c', distanceAU:0.72, periodDays:224.7, radiusKm:6051.8, fact:'Hottest planet due to a runaway greenhouse effect.' },
    { id:'earth',   name:'Earth',   type:'Terrestrial', color:'#6fb5ff', distanceAU:1.00, periodDays:365.25, radiusKm:6371.0, fact:'Only known world with life (so far).' },
    { id:'mars',    name:'Mars',    type:'Terrestrial', color:'#ff7a5a', distanceAU:1.52, periodDays:687, radiusKm:3389.5, fact:'Home to the tallest volcano in the solar system.' },
    { id:'jupiter', name:'Jupiter', type:'Gas Giant',   color:'#f1c58a', distanceAU:5.20, periodDays:4332.6, radiusKm:69911, fact:'Biggest planet; has a long-lived giant storm.' },
    { id:'saturn',  name:'Saturn',  type:'Gas Giant',   color:'#f7e1a6', distanceAU:9.58, periodDays:10759, radiusKm:58232, fact:'Famous for its spectacular ring system.' },
    { id:'uranus',  name:'Uranus',  type:'Ice Giant',   color:'#7cffd6', distanceAU:19.2, periodDays:30688.5, radiusKm:25362, fact:'Rotates on its side (extreme axial tilt).' },
    { id:'neptune', name:'Neptune', type:'Ice Giant',   color:'#5f7bff', distanceAU:30.05, periodDays:60182, radiusKm:24622, fact:'Fast winds; a very dynamic atmosphere.' },
  ];

  // Internal sim state (angles) – start evenly spaced
  let t0 = performance.now();
  planets.forEach((p, i) => {
    p.angle = (i / planets.length) * Math.PI * 2;
    p.speedBase = (365.25 / p.periodDays); // Earth years per day-ish (relative)
    p.orbitEcc = 0.05 + (i * 0.005);       // stylized
    p.size = i < 4 ? 4.5 + i*0.6 : 7.5 + (i-4)*1.0; // stylized pixel radius
    p.ring = (p.id === 'saturn');          // stylized ring
  });

  // Scale AU to pixels (depends on canvas size & zoom)
  function auToPx(au, w, h){
    const base = Math.min(w, h) * 0.38;  // base radius for ~1 AU
    return au * base * cam.zoom;
  }

  // Orbit tilt -> ellipse squash factor
  function tiltToSquash(deg){
    // 0deg -> circle (1.0), 60deg -> more squashed (~0.5)
    const t = clamp(deg / 60, 0, 1);
    return lerp(1.0, 0.55, t);
  }

  // ---------- Interactions ----------
  let isPaused = false;
  let dragging = false;
  let lastX = 0;

  canvas.addEventListener('pointerdown', (e) => {
    dragging = true;
    canvas.setPointerCapture(e.pointerId);
    lastX = e.clientX;
  });

  canvas.addEventListener('pointermove', (e) => {
    if (!dragging) return;
    const dx = e.clientX - lastX;
    lastX = e.clientX;
    cam.targetRot += dx * 0.006; // drag sensitivity
  });

  canvas.addEventListener('pointerup', () => { dragging = false; });
  canvas.addEventListener('pointercancel', () => { dragging = false; });

  // Zoom with wheel
  canvas.addEventListener('wheel', (e) => {
    e.preventDefault();
    const delta = -Math.sign(e.deltaY) * 0.10;
    cam.targetZoom = clamp(cam.targetZoom * (1 + delta), 0.55, 2.7);
  }, { passive: false });

  // Click planets for info
  canvas.addEventListener('click', (e) => {
    const rect = canvas.getBoundingClientRect();
    const mx = e.clientX - rect.left;
    const my = e.clientY - rect.top;

    const hit = pickPlanet(mx, my);
    if (hit) setSelected(hit);
    else setSelected(null); // clicks empty space -> sun
  });

  // Keyboard shortcuts
  window.addEventListener('keydown', (e) => {
    if (e.code === 'Space') { e.preventDefault(); togglePause(); }
    if (e.key.toLowerCase() === 'r') resetView();
  });

  // UI wiring
  function updateLabels(){
    speedVal.textContent = `${Number(speedEl.value).toFixed(2)}×`;
    tiltVal.textContent = `${tiltEl.value}°`;
    labelsVal.textContent = labelsEl.value === '1' ? 'On' : 'Off';
  }
  speedEl.addEventListener('input', updateLabels);
  tiltEl.addEventListener('input', updateLabels);
  labelsEl.addEventListener('input', updateLabels);
  updateLabels();

  function togglePause(){
    isPaused = !isPaused;
    pauseBtn.textContent = isPaused ? 'Resume' : 'Pause';
    pauseBtn.classList.toggle('primary', !isPaused);
  }
  pauseBtn.addEventListener('click', togglePause);
  resetBtn.addEventListener('click', resetView);

  randomBtn.addEventListener('click', () => {
    // Keep distances AU but randomize eccentricity/phase for a fun remix
    planets.forEach((p) => {
      p.orbitEcc = clamp(p.orbitEcc + (Math.random() - 0.5) * 0.12, 0.0, 0.25);
      p.angle = Math.random() * Math.PI * 2;
    });
  });

  // ---------- Selection + info ----------
  let selectedId = null;

  function setSelected(planet){
    if (!planet){
      selectedId = null;
      info.name.textContent = 'Sun';
      info.type.textContent = 'Star';
      info.dot.style.background = '#ffd36b';
      info.dot.style.boxShadow = '0 0 14px rgba(255,211,107,.45)';
      info.dist.textContent = '—';
      info.year.textContent = '—';
      info.radius.textContent = '696,340 km';
      info.fact.textContent = 'Click a planet to explore.';
      return;
    }
    selectedId = planet.id;
    info.name.textContent = planet.name;
    info.type.textContent = planet.type;
    info.dot.style.background = planet.color;
    info.dot.style.boxShadow = `0 0 14px ${hexToRGBA(planet.color, .45)}`;
    info.dist.textContent = fmtAU(planet.distanceAU);
    info.year.textContent = fmtDays(planet.periodDays);
    info.radius.textContent = fmtKm(planet.radiusKm);
    info.fact.textContent = planet.fact;
  }
  setSelected(null);

  function hexToRGBA(hex, a){
    const h = hex.replace('#','').trim();
    const r = parseInt(h.slice(0,2),16);
    const g = parseInt(h.slice(2,4),16);
    const b = parseInt(h.slice(4,6),16);
    return `rgba(${r},${g},${b},${a})`;
  }

  // ---------- Projection + planet positions ----------
  function worldToScreen(x, y, w, h){
    // Center and apply camera rotation around origin
    const cx = w / 2 + cam.panX;
    const cy = h / 2 + cam.panY;

    const c = Math.cos(cam.rot);
    const s = Math.sin(cam.rot);

    const xr = x * c - y * s;
    const yr = x * s + y * c;

    return { x: cx + xr, y: cy + yr };
  }

  function planetPos(p, w, h){
    const r = auToPx(p.distanceAU, w, h);
    const squash = tiltToSquash(Number(tiltEl.value));
    // Ellipse radius in y direction is squashed
    const a = r;
    const b = r * squash;

    // Add stylized eccentricity by shifting center slightly
    const ex = a * p.orbitEcc * 0.35;

    const x = Math.cos(p.angle) * a - ex;
    const y = Math.sin(p.angle) * b;

    return worldToScreen(x, y, w, h);
  }

  // Picking (hit test)
  function pickPlanet(mx, my){
    const w = canvas.getBoundingClientRect().width;
    const h = canvas.getBoundingClientRect().height;

    // check planets from biggest last so it's easier to click big ones in overlap
    const ordered = [...planets].sort((a,b)=> (b.size - a.size));
    for (const p of ordered){
      const pos = planetPos(p, w, h);
      const r = p.size + 6; // click padding
      const dx = mx - pos.x;
      const dy = my - pos.y;
      if (dx*dx + dy*dy <= r*r) return p;
    }
    return null;
  }

  // ---------- Rendering ----------
  function drawBackground(w, h){
    // subtle starfield
    ctx.clearRect(0,0,w,h);

    // vignette
    const g = ctx.createRadialGradient(w*0.5, h*0.45, 0, w*0.5, h*0.45, Math.max(w,h)*0.7);
    g.addColorStop(0, 'rgba(255,255,255,0.02)');
    g.addColorStop(0.35, 'rgba(255,255,255,0.01)');
    g.addColorStop(1, 'rgba(0,0,0,0.35)');
    ctx.fillStyle = g;
    ctx.fillRect(0,0,w,h);

    // stars
    const n = Math.floor((w*h) / 18000);
    ctx.save();
    for (let i=0;i<n;i++){
      const x = (hash(i*9991) * w);
      const y = (hash(i*31337+7) * h);
      const s = 0.6 + hash(i*97+19) * 1.7;
      const a = 0.10 + hash(i*211+3) * 0.25;
      ctx.fillStyle = `rgba(255,255,255,${a})`;
      ctx.fillRect(x, y, s, s);
    }
    ctx.restore();
  }

  function hash(n){
    // deterministic pseudo-random in [0,1)
    const x = Math.sin(n) * 10000;
    return x - Math.floor(x);
  }

  function drawSun(w, h){
    const c = worldToScreen(0,0,w,h);
    const sunR = 20 * cam.zoom;

    // glow
    const g = ctx.createRadialGradient(c.x, c.y, 0, c.x, c.y, sunR*6);
    g.addColorStop(0, 'rgba(255,211,107,0.95)');
    g.addColorStop(0.2, 'rgba(255,150,58,0.55)');
    g.addColorStop(0.5, 'rgba(154,60,255,0.18)');
    g.addColorStop(1, 'rgba(0,0,0,0)');
    ctx.fillStyle = g;
    ctx.beginPath();
    ctx.arc(c.x, c.y, sunR*6, 0, Math.PI*2);
    ctx.fill();

    // core
    const g2 = ctx.createRadialGradient(c.x - sunR*0.25, c.y - sunR*0.25, 0, c.x, c.y, sunR);
    g2.addColorStop(0, 'rgba(255,255,255,0.9)');
    g2.addColorStop(0.3, 'rgba(255,211,107,0.95)');
    g2.addColorStop(1, 'rgba(255,130,40,0.95)');
    ctx.fillStyle = g2;
    ctx.beginPath();
    ctx.arc(c.x, c.y, sunR, 0, Math.PI*2);
    ctx.fill();

    // subtle outline
    ctx.strokeStyle = 'rgba(255,255,255,0.18)';
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.arc(c.x, c.y, sunR, 0, Math.PI*2);
    ctx.stroke();
  }

  function drawOrbits(w, h){
    const squash = tiltToSquash(Number(tiltEl.value));
    const center = worldToScreen(0,0,w,h);

    ctx.save();
    ctx.translate(center.x, center.y);
    // apply camera rotation by rotating the whole orbit plane
    ctx.rotate(cam.rot);

    ctx.lineWidth = 1;
    for (const p of planets){
      const a = auToPx(p.distanceAU, w, h);
      const b = a * squash;
      const ex = a * p.orbitEcc * 0.35;

      ctx.strokeStyle = (p.id === selectedId)
        ? 'rgba(122,167,255,0.40)'
        : 'rgba(255,255,255,0.10)';

      ctx.beginPath();
      // ellipse centered at (-ex, 0)
      ctx.ellipse(-ex, 0, a, b, 0, 0, Math.PI*2);
      ctx.stroke();
    }
    ctx.restore();
  }

  function drawPlanet(p, w, h){
    const pos = planetPos(p, w, h);

    // shadow/halo
    ctx.save();
    ctx.fillStyle = hexToRGBA(p.color, 0.18);
    ctx.beginPath();
    ctx.arc(pos.x, pos.y, (p.size + 10), 0, Math.PI*2);
    ctx.fill();

    // body
    const isSel = p.id === selectedId;
    const r = p.size * cam.zoom * 0.95; // keep sizes reasonable with zoom

    const grad = ctx.createRadialGradient(pos.x - r*0.35, pos.y - r*0.35, 0, pos.x, pos.y, r);
    grad.addColorStop(0, 'rgba(255,255,255,0.55)');
    grad.addColorStop(0.25, hexToRGBA(p.color, 0.95));
    grad.addColorStop(1, 'rgba(0,0,0,0.75)');

    ctx.fillStyle = grad;
    ctx.beginPath();
    ctx.arc(pos.x, pos.y, r, 0, Math.PI*2);
    ctx.fill();

    // ring (Saturn)
    if (p.ring){
      ctx.strokeStyle = 'rgba(247,225,166,0.35)';
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.ellipse(pos.x, pos.y, r*2.0, r*0.9, -0.25, 0, Math.PI*2);
      ctx.stroke();
    }

    // outline
    ctx.strokeStyle = isSel ? 'rgba(122,167,255,0.85)' : 'rgba(255,255,255,0.22)';
    ctx.lineWidth = isSel ? 2 : 1;
    ctx.beginPath();
    ctx.arc(pos.x, pos.y, r, 0, Math.PI*2);
    ctx.stroke();

    // label
    if (labelsEl.value === '1'){
      ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'top';
      ctx.fillStyle = isSel ? 'rgba(233,238,252,0.95)' : 'rgba(170,180,208,0.85)';
      ctx.fillText(p.name, pos.x, pos.y + r + 8);
    }

    ctx.restore();
  }

  // ---------- Animation loop ----------
  function tick(now){
    const w = canvas.getBoundingClientRect().width;
    const h = canvas.getBoundingClientRect().height;

    // smooth camera
    cam.rot = lerp(cam.rot, cam.targetRot, 0.12);
    cam.zoom = lerp(cam.zoom, cam.targetZoom, 0.12);

    // update simulation
    const dt = Math.min(0.05, (now - t0) / 1000); // seconds
    t0 = now;

    if (!isPaused){
      const speed = Number(speedEl.value);
      for (const p of planets){
        // base angular speed is relative to period; scaled and tuned for nice motion
        const omega = 0.55 * p.speedBase * speed; // rad/sec-ish (stylized)
        p.angle = (p.angle + omega * dt) % (Math.PI * 2);
      }
    }

    // draw
    drawBackground(w, h);
    drawOrbits(w, h);
    drawSun(w, h);

    // draw planets back-to-front: sort by rotated y to fake depth
    const withDepth = planets.map(p => {
      const pos = planetPos(p, w, h);
      return { p, y: pos.y };
    }).sort((a,b) => a.y - b.y);
    for (const item of withDepth) drawPlanet(item.p, w, h);

    requestAnimationFrame(tick);
  }
  requestAnimationFrame(tick);

})();
</script>
</body>
</html>
